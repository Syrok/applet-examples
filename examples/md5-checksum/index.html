<!doctype html>
<html>
<head>
    <title>Offline Files</title>
</head>
<body style="text-align: center; background-color: #F4D03F; color: #333;margin: 0; padding: 0;position: absolute;width: 100%;height: 100%;">
<h1>MD5 Checksum</h1>
<p id="index">... loading ...</p>


<script type="application/ecmascript">
	window.addEventListener('sos.loaded', async function () {

		await sos.onReady();

		const files = [
			{ uid: 'video-1', uri: 'https://hugstatic.blob.core.windows.net/assets/video-test-1_e07fc21a7a72e3d33478243bd75d7743.mp4' },
			{ uid: 'image-1', uri: 'https://hugstatic.blob.core.windows.net/assets/android-benq-amy_bbd9afbc0655ceb6da790a80fbd90290.png' }
        ];

		// Save all files parallel
		await Promise.all(files.map(async (content) => {
			// Store files to offline storage (https://docs.signageos.io/api/sos-applet-api/#Load_or_Save_specific_file_into_internal_memory)
			const { filePath } = await sos.offline.cache.loadOrSaveFile(content.uid, content.uri);
			content.filePath = filePath;
		}));

		console.log('Files are loaded');

		// Generate hash for video
		const videoHash = await sos.offline.cache.getChecksumFile('video-1', 'md5');
		console.log('Video hash: ' + videoHash);

		// Generate hash for image
		const imageHash = await sos.offline.cache.getChecksumFile('image-1', 'md5');
		console.log('Image hash: ' + imageHash);

		// Validate hash for video
		const validHashVideo1 = await sos.offline.cache.validateChecksumFile('video-1', videoHash, 'md5');
		console.log('Has video same hash as request: ' + validHashVideo1);

		// Validate hash for image
		const validHashImage1 = await sos.offline.cache.validateChecksumFile('image-1', 'incorrect-hash', 'md5');
		console.log('Has image same hash as incorrect hash: ' + validHashImage1);

	});
</script>
</body>
</html>
